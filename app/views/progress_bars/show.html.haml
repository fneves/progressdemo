.row-fluid
  .progress-bar
    %h2
      = @progress_bar.name

- if logged_in? then
  .row-fluid
    .span12
      .pull-right
        %a{:href => new_progress_bar_task_path(@progress_bar), :class=>'btn'}
          %i.icon-plus-sign-alt &nbsp;Add Task

.row-fluid
  .big-percentage
    -#.well.span6.stitched
    .span6
      .pull-left
        %p
          %i.green.impact.icon-ok
          #{percentage(@tasks)[:completed]}% completed
        %p
          %i.orange.impact.icon-time
          #{percentage(@tasks)[:delayed]}% delayed
        %p
          %i.red.impact.icon-ban-circle
          #{percentage(@tasks)[:canceled]}% canceled
        %p
          %i.blue.impact.icon-calendar
          #{percentage(@tasks)[:planned]}% planned

%br
%br


.row-fluid
  .span12
    .progress
      .bar.bar-success{:style=>"width:#{percentage(@tasks)[:completed]}%"}
      .bar.bar-warning{:style=>"width:#{percentage(@tasks)[:delayed]}%"}
      .bar.bar-danger{:style=>"width:#{percentage(@tasks)[:canceled]}%"}
      .bar.bar-info{:style=>"width:#{percentage(@tasks)[:planned]}%"}

.row
  .equidistant
    %ul.span12.task-list{:id => 'task-list'}
      - @tasks.each do |task|
        %li
          .bubble.task{:data => {:progress => @progress_bar.id, :task => task.id}}
            .task-edit
              = link_to edit_progress_bar_task_path(@progress_bar, task) do
                %i.icon-edit
            .task-delete
              = link_to progress_bar_task_path(@progress_bar, task), :method => :delete, :data => { :confirm => 'Are you sure you want to delete this task?' } do
                %i.icon-trash
            .task-date
              %span{ :class => 'hint--bottom' , :data => {'hint' => task.duedate.to_s} }
                = task.duedate.strftime('Due on %d/%m/%Y')
            .task-description
              %span.title
                =task.title
            .task-status
              %i{ :class => "#{marker_icon(task)}" }
                &nbsp;#{task.status_descr()}



%br
- if logged_in? then
  = link_to edit_progress_bar_path(@progress_bar) do
    %i.icon-edit &nbsp;Edit


:javascript
  $(document).ready(function(){
     $('.bubble').click(function(){
       var progress_id = $(this).data('progress');
       var task_id = $(this).data('task');
       var url = '/progress_bars/' + progress_id + '/tasks/' + task_id;
       document.location.href = url;
     });
  });